FROM devopsbq/minimal:1.0

MAINTAINER Ops@bq <devops@bq.com>

ENV DW_HTTP_PORT 8082
ENV DW_HTTP_ADMINPORT 8083

ENV MONGODB_HOST localhost
ENV MONGODB_PORT 27017
ENV MONGODB_AUTOCONNECTRETRY true
ENV MONGODB_CONNECTIONSPERHOST 20
#ENV MONGODB_USER
#ENV MONGODB_PASSWORD

ENV REDIS_HOST localhost
ENV REDIS_PORT 6379
#ENV REDIS_PASSWORD

ENV RABBITMQ_HOST localhost
ENV RABBITMQ_PORT 5672
ENV RABBITMQ_USER guest
ENV RABBITMQ_PASSWORD guest

COPY iam.jar /app/iam.jar
COPY start.sh /app/start.sh

EXPOSE 8082
EXPOSE 8083

RUN chmod 755 /app/start.sh

WORKDIR /app

CMD ["/app/start.sh", "iam"]
